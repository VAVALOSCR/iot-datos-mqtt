<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Robot M√≥vil - Proyecto Final</title>

<style>

/* ===== GENERAL ===== */

body{
    background:#08131f;
    font-family:Arial;
    color:white;
    text-align:center;
}

h1{
    color:#00ffcc;
}

/* ===== MAPA ===== */

#mapa{
    width:800px;
    height:450px;
    background:#111;
    margin:auto;
    border:4px solid cyan;
    position:relative;
    overflow:hidden;
}

/* ===== ROBOT ===== */

#robot{
    width:60px;
    height:80px;
    background:#333;
    border:2px solid #00ffcc;
    position:absolute;
    left:100px;
    top:200px;
    border-radius:10px;

    transition:0.15s;
}

/* Cabeza */
#head{
    width:40px;
    height:20px;
    background:#111;
    position:absolute;
    top:-22px;
    left:10px;
    border-radius:6px;
}

.eye{
    width:6px;
    height:6px;
    background:red;
    border-radius:50%;
    position:absolute;
    top:7px;
}

#eye1{ left:6px; }
#eye2{ right:6px; }

/* Ruedas */

.wheel{
    width:14px;
    height:20px;
    background:#888;
    position:absolute;
    border-radius:3px;
}

#w1{ left:-14px; top:15px; }
#w2{ left:-14px; bottom:15px; }
#w3{ right:-14px; top:15px; }
#w4{ right:-14px; bottom:15px; }

/* ===== SENSOR ===== */

#sensor{
    position:absolute;
    width:4px;
    height:4px;
    background:lime;
    left:28px;
    top:-5px;
}

#rayo{
    position:absolute;
    width:3px;
    background:lime;
    top:-200px;
    left:28px;
    height:0px;
}

/* ===== OBSTACULOS ===== */

.obstaculo{
    width:50px;
    height:50px;
    background:#aa0000;
    position:absolute;
    border-radius:5px;
}

/* ===== PANEL ===== */

#panel{
    width:800px;
    margin:auto;
    margin-top:10px;
    display:flex;
    justify-content:space-around;
}

.box{
    border:1px solid cyan;
    padding:10px;
    width:180px;
}

/* BOTONES */

button{
    padding:6px 12px;
    background:#00ffcc;
    border:none;
    border-radius:4px;
    cursor:pointer;
}

button:hover{
    background:#00ccaa;
}

</style>
</head>

<body>

<h1>ü§ñ ROBOT M√ìVIL - PROYECTO FINAL</h1>

<div id="mapa">

<!-- ROBOT -->

<div id="robot">

<div id="head">
    <div id="eye1" class="eye"></div>
    <div id="eye2" class="eye"></div>
</div>

<div class="wheel" id="w1"></div>
<div class="wheel" id="w2"></div>
<div class="wheel" id="w3"></div>
<div class="wheel" id="w4"></div>

<div id="sensor"></div>
<div id="rayo"></div>

</div>

<!-- OBSTACULOS -->
<div class="obstaculo" style="left:400px;top:100px"></div>
<div class="obstaculo" style="left:600px;top:300px"></div>
<div class="obstaculo" style="left:300px;top:250px"></div>

</div>

<!-- PANEL -->

<div id="panel">

<div class="box">
<h3>Control</h3>
<button onclick="adelante()">‚¨Ü</button><br><br>
<button onclick="izq()">‚¨Ö</button>
<button onclick="stop()">‚èπ</button>
<button onclick="der()">‚û°</button><br><br>
<button onclick="atras()">‚¨á</button>
</div>

<div class="box">
<h3>Ultras√≥nico</h3>
<p>Distancia:</p>
<h2 id="dist">0 cm</h2>
</div>

<div class="box">
<h3>Puntaje</h3>
<h2 id="score">0</h2>
</div>

<div class="box">
<h3>Estado</h3>
<p id="estado">Listo</p>
</div>

</div>

<script>

/* POSICION */

let x=100;
let y=200;
let vel=8;

let score=0;

const robot=document.getElementById("robot");
const rayo=document.getElementById("rayo");
const dist=document.getElementById("dist");
const estado=document.getElementById("estado");

/* MOVER */

function mover(){

    robot.style.left=x+"px";
    robot.style.top=y+"px";

    medir();
    colision();
}

/* COMANDOS */

function adelante(){
    y-=vel;
    mover();
}

function atras(){
    y+=vel;
    mover();
}

function izq(){
    x-=vel;
    mover();
}

function der(){
    x+=vel;
    mover();
}

function stop(){
    estado.innerText="STOP";
}

/* SENSOR */

function medir(){

    let min=300;

    let obs=document.querySelectorAll(".obstaculo");

    obs.forEach(o=>{

        let ox=o.offsetLeft;
        let oy=o.offsetTop;

        let dx=(ox+25)-(x+30);
        let dy=(oy+25)-(y);

        if(dy<0 && Math.abs(dx)<40){

            let d=Math.abs(dy);

            if(d<min) min=d;
        }
    });

    dist.innerText=min+" cm";

    rayo.style.height=min+"px";
}

/* COLISION */

function colision(){

    let obs=document.querySelectorAll(".obstaculo");

    obs.forEach(o=>{

        let ox=o.offsetLeft;
        let oy=o.offsetTop;

        if(
           x<ox+50 &&
           x+60>ox &&
           y<oy+50 &&
           y+80>oy
        ){

            score-=5;
            score=Math.max(0,score);

            document.getElementById("score").innerText=score;

            estado.innerText="üí• CHOQUE";
        }
        else{
            score++;
            document.getElementById("score").innerText=score;
        }
    });
}

/* TECLADO */

document.addEventListener("keydown",e=>{

    if(e.key=="ArrowUp") adelante();
    if(e.key=="ArrowDown") atras();
    if(e.key=="ArrowLeft") izq();
    if(e.key=="ArrowRight") der();
    if(e.key==" ") stop();

});

</script>

</body>
</html>
